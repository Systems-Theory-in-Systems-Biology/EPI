

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>tests package &mdash; EPI  documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/copybutton.css" type="text/css" />
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script src="_static/clipboard.min.js"></script>
        <script src="_static/copybutton.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Tutorial" href="tutorial_material/tutorial.html" />
    <link rel="prev" title="epi.plotting package" href="epi.plotting.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> EPI
          

          
            
            <img src="_static/epi.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">API DOC</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="epi.html">epi package</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">tests package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-tests.conftest">tests.conftest module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tests.conftest.pytest_sessionstart"><code class="docutils literal notranslate"><span class="pre">pytest_sessionstart()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-tests.profiling">tests.profiling module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-tests.test_cpp">tests.test_cpp module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tests.test_cpp.test_cpp_lib_exists"><code class="docutils literal notranslate"><span class="pre">test_cpp_lib_exists()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-tests.test_examples">tests.test_examples module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tests.test_examples.Examples"><code class="docutils literal notranslate"><span class="pre">Examples()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tests.test_examples.getExampleName"><code class="docutils literal notranslate"><span class="pre">getExampleName()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tests.test_examples.test_examples"><code class="docutils literal notranslate"><span class="pre">test_examples()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-tests.test_jax">tests.test_jax module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tests.test_jax.do_matrix_multiplication"><code class="docutils literal notranslate"><span class="pre">do_matrix_multiplication()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tests.test_jax.test_jax_cpu"><code class="docutils literal notranslate"><span class="pre">test_jax_cpu()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tests.test_jax.test_jax_gpu"><code class="docutils literal notranslate"><span class="pre">test_jax_gpu()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-tests.test_kde">tests.test_kde module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tests.test_kde.kde_data_test_set"><code class="docutils literal notranslate"><span class="pre">kde_data_test_set()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tests.test_kde.kernel_estimators"><code class="docutils literal notranslate"><span class="pre">kernel_estimators()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tests.test_kde.test_KDE_batch"><code class="docutils literal notranslate"><span class="pre">test_KDE_batch()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tests.test_kde.test_KDE_data"><code class="docutils literal notranslate"><span class="pre">test_KDE_data()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-tests.test_plotting">tests.test_plotting module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tests.test_plotting.test_plotKDEoverGrid"><code class="docutils literal notranslate"><span class="pre">test_plotKDEoverGrid()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-tests.test_simple_models">tests.test_simple_models module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tests.test_simple_models.test_transformationExponential"><code class="docutils literal notranslate"><span class="pre">test_transformationExponential()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tests.test_simple_models.test_transformationLinear"><code class="docutils literal notranslate"><span class="pre">test_transformationLinear()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tests.test_simple_models.test_transformationODELinear"><code class="docutils literal notranslate"><span class="pre">test_transformationODELinear()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-tests">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_material/tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Example Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="MarkdownLinks/development.html">Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="MarkdownLinks/contributing.html">Contributing to EPI</a></li>
<li class="toctree-l1"><a class="reference internal" href="MarkdownLinks/license.html">LICENSE</a></li>
<li class="toctree-l1"><a class="reference internal" href="MarkdownLinks/citation.html">Citation</a></li>
<li class="toctree-l1"><a class="reference internal" href="MarkdownLinks/todos.html">TODOs</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">EPI</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="modules.html">EPI</a> &raquo;</li>
        
      <li>tests package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/tests.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <section id="tests-package">
<h1>tests package<a class="headerlink" href="#tests-package" title="Permalink to this heading">¶</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading">¶</a></h2>
</section>
<section id="module-tests.conftest">
<span id="tests-conftest-module"></span><h2>tests.conftest module<a class="headerlink" href="#module-tests.conftest" title="Permalink to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="tests.conftest.pytest_sessionstart">
<span class="sig-prename descclassname"><span class="pre">tests.conftest.</span></span><span class="sig-name descname"><span class="pre">pytest_sessionstart</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">session</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tests.conftest.pytest_sessionstart" title="Permalink to this definition">¶</a></dt>
<dd><p>Called once at the start of a pytest session</p>
<p>Currently disables the matplotlib output</p>
</dd></dl>

</section>
<section id="module-tests.profiling">
<span id="tests-profiling-module"></span><h2>tests.profiling module<a class="headerlink" href="#module-tests.profiling" title="Permalink to this heading">¶</a></h2>
<p>The code which is executed here should contain code which represents the typical usage of the epi library.
It could be extended to somehow measure the performance of the code for all examples in a reproducible and comparable way.
At the moment the simplest way to get an indication for the performance is to run the tests and look at the time it takes to run the tests.
For profiling / identifying bottlenecks and not just observing the iterations per seconds, run this file with the following command:
scalene tests/profiling.py from the root directory of the project.</p>
</section>
<section id="module-tests.test_cpp">
<span id="tests-test-cpp-module"></span><h2>tests.test_cpp module<a class="headerlink" href="#module-tests.test_cpp" title="Permalink to this heading">¶</a></h2>
<p>Test the cpp model and its equivalent python implementation. Can be used to compare the performance during the sampling.</p>
<dl class="py function">
<dt class="sig sig-object py" id="tests.test_cpp.test_cpp_lib_exists">
<span class="sig-prename descclassname"><span class="pre">tests.test_cpp.</span></span><span class="sig-name descname"><span class="pre">test_cpp_lib_exists</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tests.test_cpp.test_cpp_lib_exists" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="module-tests.test_examples">
<span id="tests-test-examples-module"></span><h2>tests.test_examples module<a class="headerlink" href="#module-tests.test_examples" title="Permalink to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="tests.test_examples.Examples">
<span class="sig-prename descclassname"><span class="pre">tests.test_examples.</span></span><span class="sig-name descname"><span class="pre">Examples</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tests.test_examples.Examples" title="Permalink to this definition">¶</a></dt>
<dd><p>Provides the list of examples to the parametrized test</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tests.test_examples.getExampleName">
<span class="sig-prename descclassname"><span class="pre">tests.test_examples.</span></span><span class="sig-name descname"><span class="pre">getExampleName</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">example</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tests.test_examples.getExampleName" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract the name of the example from the tuple to have nice names in the test report and be able to select the test using -k</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tests.test_examples.test_examples">
<span class="sig-prename descclassname"><span class="pre">tests.test_examples.</span></span><span class="sig-name descname"><span class="pre">test_examples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">example</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tests.test_examples.test_examples" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="module-tests.test_jax">
<span id="tests-test-jax-module"></span><h2>tests.test_jax module<a class="headerlink" href="#module-tests.test_jax" title="Permalink to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="tests.test_jax.do_matrix_multiplication">
<span class="sig-prename descclassname"><span class="pre">tests.test_jax.</span></span><span class="sig-name descname"><span class="pre">do_matrix_multiplication</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5000</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tests.test_jax.do_matrix_multiplication" title="Permalink to this definition">¶</a></dt>
<dd><p>Do a simple matrix-matrix multiplication for two random matrices generated by numpy</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>n</strong> (<em>int</em><em>, </em><em>optional</em>) – number of entries per dimension, defaults to 5000</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tests.test_jax.test_jax_cpu">
<span class="sig-prename descclassname"><span class="pre">tests.test_jax.</span></span><span class="sig-name descname"><span class="pre">test_jax_cpu</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tests.test_jax.test_jax_cpu" title="Permalink to this definition">¶</a></dt>
<dd><p>Test wether jax can run on the cpu by executing some jax code</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tests.test_jax.test_jax_gpu">
<span class="sig-prename descclassname"><span class="pre">tests.test_jax.</span></span><span class="sig-name descname"><span class="pre">test_jax_gpu</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tests.test_jax.test_jax_gpu" title="Permalink to this definition">¶</a></dt>
<dd><p>Test wether jax can run on the gpu by executing some jax code.
The jax gpu test may fail if no nvidia gpu is available or the cuda and cudnn libraries are not installed.</p>
</dd></dl>

</section>
<section id="module-tests.test_kde">
<span id="tests-test-kde-module"></span><h2>tests.test_kde module<a class="headerlink" href="#module-tests.test_kde" title="Permalink to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="tests.test_kde.kde_data_test_set">
<span class="sig-prename descclassname"><span class="pre">tests.test_kde.</span></span><span class="sig-name descname"><span class="pre">kde_data_test_set</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tests.test_kde.kde_data_test_set" title="Permalink to this definition">¶</a></dt>
<dd><p>Yields test data for the KDE data tests</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tests.test_kde.kernel_estimators">
<span class="sig-prename descclassname"><span class="pre">tests.test_kde.</span></span><span class="sig-name descname"><span class="pre">kernel_estimators</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tests.test_kde.kernel_estimators" title="Permalink to this definition">¶</a></dt>
<dd><p>Yields the kernel density estimators</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tests.test_kde.test_KDE_batch">
<span class="sig-prename descclassname"><span class="pre">tests.test_kde.</span></span><span class="sig-name descname"><span class="pre">test_KDE_batch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evalKDE</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tests.test_kde.test_KDE_batch" title="Permalink to this definition">¶</a></dt>
<dd><p>Test both kernel density estimators by using random data points and evaluating the Kernel Density Estimation at one point</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tests.test_kde.test_KDE_data">
<span class="sig-prename descclassname"><span class="pre">tests.test_kde.</span></span><span class="sig-name descname"><span class="pre">test_KDE_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">evalKDE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stdevs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_bounds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">33</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tests.test_kde.test_KDE_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Test both kernel density estimators by using one data point and evaluating the Kernel Density Estimation over a grid</p>
</dd></dl>

</section>
<section id="module-tests.test_plotting">
<span id="tests-test-plotting-module"></span><h2>tests.test_plotting module<a class="headerlink" href="#module-tests.test_plotting" title="Permalink to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="tests.test_plotting.test_plotKDEoverGrid">
<span class="sig-prename descclassname"><span class="pre">tests.test_plotting.</span></span><span class="sig-name descname"><span class="pre">test_plotKDEoverGrid</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tests.test_plotting.test_plotKDEoverGrid" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="module-tests.test_simple_models">
<span id="tests-test-simple-models-module"></span><h2>tests.test_simple_models module<a class="headerlink" href="#module-tests.test_simple_models" title="Permalink to this heading">¶</a></h2>
<p>Contains grid based evaluations and plotting of models, which implement simple transformations: Linear, Exponential, LinearODE</p>
<dl class="py function">
<dt class="sig sig-object py" id="tests.test_simple_models.test_transformationExponential">
<span class="sig-prename descclassname"><span class="pre">tests.test_simple_models.</span></span><span class="sig-name descname"><span class="pre">test_transformationExponential</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tests.test_simple_models.test_transformationExponential" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tests.test_simple_models.test_transformationLinear">
<span class="sig-prename descclassname"><span class="pre">tests.test_simple_models.</span></span><span class="sig-name descname"><span class="pre">test_transformationLinear</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tests.test_simple_models.test_transformationLinear" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tests.test_simple_models.test_transformationODELinear">
<span class="sig-prename descclassname"><span class="pre">tests.test_simple_models.</span></span><span class="sig-name descname"><span class="pre">test_transformationODELinear</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tests.test_simple_models.test_transformationODELinear" title="Permalink to this definition">¶</a></dt>
<dd><p>Exemplary application of Eulerian Parameter Inference a very simplistic ordinary differential equation model.
We create our toy data by first defining a true parameter distribution.
The actual data is then obtained by evaluating the model in parameters drawn from this true distribution.
Ideally, we would be able to reconstruct the true parameter density.
However, we will see that this parameter inference problem possesses more than one solution and is therefore not well-posed.</p>
</dd></dl>

</section>
<section id="module-tests">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-tests" title="Permalink to this heading">¶</a></h2>
</section>
</section>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="tutorial_material/tutorial.html" class="btn btn-neutral float-right" title="Tutorial" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="epi.plotting.html" class="btn btn-neutral float-left" title="epi.plotting package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2022-2023, Vincent Wagner, Sebastian Höpfl, Lars Kaiser.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
  
 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header").click(function() {
            $(this).parent().children().not(".header").toggle(400);
            $(this).parent().children(".header").toggleClass("open");
        })
    });
</script>


</body>
</html>